# –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Ç–∏—Ä–∞–º

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∏—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ ‚úÖ
- **FREE**: 2 –ø—Ä–æ–µ–∫—Ç–∞/–º–µ—Å, –±–µ–∑ –¥–µ–ø–ª–æ—è
- **STARTER**: 10 –ø—Ä–æ–µ–∫—Ç–æ–≤/–º–µ—Å, 10 –¥–µ–ø–ª–æ–µ–≤/–º–µ—Å  
- **PRO**: 50 –ø—Ä–æ–µ–∫—Ç–æ–≤/–º–µ—Å, 100 –¥–µ–ø–ª–æ–µ–≤/–º–µ—Å
- **TEAM**: –±–µ–∑–ª–∏–º–∏—Ç

### 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º ‚úÖ

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ (api/routers/projects.py)
```python
@router.post("/")
async def create_project(
    ...,
    _limits_check = Depends(require_project_limits)  # ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
)
```

#### Preview/Deploy (api/routers/preview.py)
```python
@router.post("/projects/{project_id}/preview/start")
async def start_preview(
    ...,
    _deploy_check = Depends(require_deploy_access)  # ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–µ–ø–ª–æ—é
)
```

#### Git –æ–ø–µ—Ä–∞—Ü–∏–∏ (api/routers/plugins.py)
```python
@router.post("/plugins/{plugin_name}/github/create-repo")
async def create_github_repo(
    ...,
    _git_check = Depends(require_git_push_access)  # ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ git –¥–æ—Å—Ç—É–ø–∞
)
```

### 3. BYOK –º–æ–¥–µ–ª—å –¥–ª—è LLM ‚úÖ

**–ö–ª—é—á–µ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω—ã –≤—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –º–æ–¥–µ–ª—è–º!

–ü—Ä–∏—á–∏–Ω–∞: –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å BYOK (Bring Your Own Key) - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ API –∫–ª—é—á–∏ –¥–ª—è LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.

#### api/routers/models.py
```python
# –í—Å–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
@router.get("/models")
async def get_available_models():  # –ë–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏!
    return PROVIDER_MODELS  # –í—Å–µ –º–æ–¥–µ–ª–∏ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
```

### 4. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚úÖ

–§–∞–π–ª: `core/api/middleware/tier_limits.py`

**–§—É–Ω–∫—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:**
- ‚úÖ `require_project_limits()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–µ–∫—Ç—ã
- ‚úÖ `require_deploy_access()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–µ–ø–ª–æ—é
- ‚úÖ `require_export_access()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–∫—Å–ø–æ—Ä—Ç—É
- ‚úÖ `require_git_push_access()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ git –æ–ø–µ—Ä–∞—Ü–∏—è–º
- ‚úÖ `get_tier_info()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–∏—Ä–µ

**–£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è BYOK):**
- ‚ùå `get_allowed_models()` - —É–¥–∞–ª–µ–Ω–æ
- ‚ùå `is_model_allowed()` - —É–¥–∞–ª–µ–Ω–æ  
- ‚ùå `require_model_access()` - —É–¥–∞–ª–µ–Ω–æ

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–∏—Ä–∞–º:

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | –§–∞–π–ª |
|----------|-------------|------|
| POST /projects | –õ–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ | api/routers/projects.py |
| POST /projects/{id}/preview/start | –î–æ—Å—Ç—É–ø –∫ preview (—Ç–æ–ª—å–∫–æ STARTER+) | api/routers/preview.py |
| POST /plugins/{name}/github/create-repo | –õ–∏–º–∏—Ç git –æ–ø–µ—Ä–∞—Ü–∏–π | api/routers/plugins.py |
| GET /user/tier | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏—Ä–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | api/routers/user.py |

### –ì–¥–µ –ù–ï –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|---------|
| GET /models | BYOK - –≤—Å–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã |
| POST /keys | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏–º–∏ –∫–ª—é—á–∞–º–∏ |
| GET /projects | –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ |

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ –∫–æ–¥–µ:

1. **–°—Ç–∞—Ä—ã–π —Ñ–∞–π–ª limits.py —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** (`core/api/middleware/limits.py`)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `core/api/routers/projects.py` (—Å—Ç–∞—Ä—ã–π —Ä–æ—É—Ç–µ—Ä)
   - –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º API (`api/routers/projects.py`)
   
2. **–ù–æ–≤—ã–π —Ñ–∞–π–ª tier_limits.py —Å–æ–∑–¥–∞–Ω** (`core/api/middleware/tier_limits.py`)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `api/routers/projects.py` ‚úÖ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `api/routers/preview.py` ‚úÖ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `api/routers/plugins.py` ‚úÖ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `api/routers/user.py` ‚úÖ

3. **–û—Å–Ω–æ–≤–Ω–æ–π API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**
   - `api/main.py` –ø–æ–¥–∫–ª—é—á–∞–µ—Ç —Ä–æ—É—Ç–µ—Ä—ã –∏–∑ `api/routers/` ‚úÖ
   - –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è tier_limits ‚úÖ

### ‚úÖ –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:

–§–∞–π–ª: `tests/api/test_tier_limits.py` (187 —Å—Ç—Ä–æ–∫)

**–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Ç–∏—Ä–æ–≤
- –ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–∏—Ä–æ–≤ (–∫–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π –ª—É—á—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏—Ä–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
- BYOK –º–æ–¥–µ–ª—å (–≤—Å–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º)

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### 402 Payment Required
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∏–≥ –ª–∏–º–∏—Ç–∞ —Å–≤–æ–µ–≥–æ —Ç–∏—Ä–∞:
```json
{
  "detail": "Monthly project limit reached (2 projects). Upgrade to starter for more projects."
}
```

### 403 Forbidden  
–ö–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ç–µ–∫—É—â–µ–º —Ç–∏—Ä–µ:
```json
{
  "detail": "Feature 'deploy' is not available in your current plan (free). Upgrade to starter to access this feature."
}
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

1. **TIER_LIMITS_IMPLEMENTATION.md** (403 —Å—Ç—Ä–æ–∫–∏)
   - –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏—Ä–æ–≤
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
   - –ö–æ–¥—ã –æ—à–∏–±–æ–∫
   - –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

2. **TIER_LIMITS_FINAL_CHECK.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
   - –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
   - –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

## –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| core/api/middleware/tier_limits.py | ‚úÖ –°–æ–∑–¥–∞–Ω | –°–∏—Å—Ç–µ–º–∞ tier-based –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (333 —Å—Ç—Ä–æ–∫–∏) |
| api/routers/projects.py | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ require_project_limits |
| api/routers/preview.py | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ require_deploy_access |
| api/routers/plugins.py | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ require_git_push_access |
| api/routers/user.py | ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω | –î–æ–±–∞–≤–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç /user/tier |
| api/routers/models.py | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω | –í–æ–∑–≤—Ä–∞—â—ë–Ω –≤ BYOK —Ä–µ–∂–∏–º (–±–µ–∑ tier —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏) |
| tests/api/test_tier_limits.py | ‚úÖ –°–æ–∑–¥–∞–Ω | –¢–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã (187 —Å—Ç—Ä–æ–∫) |
| TIER_LIMITS_IMPLEMENTATION.md | ‚úÖ –°–æ–∑–¥–∞–Ω | –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (403 —Å—Ç—Ä–æ–∫–∏) |
| TIER_LIMITS_FINAL_CHECK.md | ‚úÖ –°–æ–∑–¥–∞–Ω | –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ |

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –í—Å–µ —Ç–∏—Ä—ã –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- FREE: 2 –ø—Ä–æ–µ–∫—Ç–∞, –±–µ–∑ –¥–µ–ø–ª–æ—è
- STARTER: 10 –ø—Ä–æ–µ–∫—Ç–æ–≤, 10 –¥–µ–ø–ª–æ–µ–≤  
- PRO: 50 –ø—Ä–æ–µ–∫—Ç–æ–≤, 100 –¥–µ–ø–ª–æ–µ–≤
- TEAM: –±–µ–∑–ª–∏–º–∏—Ç

### ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ API
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤: `require_project_limits`
- –î–µ–ø–ª–æ–π/Preview: `require_deploy_access`
- Git –æ–ø–µ—Ä–∞—Ü–∏–∏: `require_git_push_access`

### ‚úÖ BYOK –º–æ–¥–µ–ª—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –í—Å–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤–æ–∏ API –∫–ª—é—á–∏
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –º–æ–¥–µ–ª—è–º

### ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- 402 –¥–ª—è –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤
- 403 –¥–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∞–ø–≥—Ä–µ–π–¥–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö

### ‚úÖ –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–∏—Ä–æ–≤
- –î–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º
- –õ–∏–º–∏—Ç—ã –ø—Ä–æ–µ–∫—Ç–æ–≤
- BYOK –º–æ–¥–µ–ª—å

## üéâ –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.
