<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Core Web Vitals Measurement</title>
  <script type="module">
    // Import web-vitals library from CDN
    import {onCLS, onINP, onLCP, onFCP, onFID, onTTFB} from 'https://unpkg.com/web-vitals@4/dist/web-vitals.js?module';

    const vitalsResults = {
      lcp: null,
      inp: null,
      cls: null,
      fcp: null,
      fid: null,
      ttfb: null
    };

    function sendToAnalytics(metric) {
      const metricName = metric.name.toLowerCase();
      vitalsResults[metricName] = metric.value;
      
      console.log(`${metric.name}:`, metric.value);
      
      // Update display
      updateDisplay();
    }

    function updateDisplay() {
      const resultsDiv = document.getElementById('results');
      const passed = {
        lcp: vitalsResults.lcp && vitalsResults.lcp <= 2500,
        inp: vitalsResults.inp && vitalsResults.inp <= 200,
        cls: vitalsResults.cls && vitalsResults.cls <= 0.1,
        fcp: vitalsResults.fcp && vitalsResults.fcp <= 1800,
        fid: vitalsResults.fid && vitalsResults.fid <= 100,
        ttfb: vitalsResults.ttfb && vitalsResults.ttfb <= 800
      };

      resultsDiv.innerHTML = `
        <h2>üìä Core Web Vitals Results</h2>
        <div class="metric ${passed.lcp ? 'pass' : 'fail'}">
          <strong>LCP (Largest Contentful Paint):</strong> 
          ${vitalsResults.lcp ? `${(vitalsResults.lcp / 1000).toFixed(3)}s` : 'Measuring...'} 
          ${vitalsResults.lcp ? (passed.lcp ? '‚úÖ' : '‚ùå') : ''} 
          <span class="target">(Target: ‚â§ 2.5s)</span>
        </div>
        <div class="metric ${passed.inp ? 'pass' : 'fail'}">
          <strong>INP (Interaction to Next Paint):</strong> 
          ${vitalsResults.inp ? `${vitalsResults.inp.toFixed(0)}ms` : 'Measuring...'} 
          ${vitalsResults.inp ? (passed.inp ? '‚úÖ' : '‚ùå') : ''} 
          <span class="target">(Target: ‚â§ 200ms)</span>
        </div>
        <div class="metric ${passed.cls ? 'pass' : 'fail'}">
          <strong>CLS (Cumulative Layout Shift):</strong> 
          ${vitalsResults.cls !== null ? vitalsResults.cls.toFixed(3) : 'Measuring...'} 
          ${vitalsResults.cls !== null ? (passed.cls ? '‚úÖ' : '‚ùå') : ''} 
          <span class="target">(Target: ‚â§ 0.1)</span>
        </div>
        <hr>
        <h3>Additional Metrics:</h3>
        <div class="metric ${passed.fcp ? 'pass' : 'warn'}">
          <strong>FCP (First Contentful Paint):</strong> 
          ${vitalsResults.fcp ? `${(vitalsResults.fcp / 1000).toFixed(3)}s` : 'Measuring...'} 
          ${vitalsResults.fcp ? (passed.fcp ? '‚úÖ' : '‚ö†Ô∏è') : ''} 
          <span class="target">(Target: ‚â§ 1.8s)</span>
        </div>
        <div class="metric ${passed.fid ? 'pass' : 'warn'}">
          <strong>FID (First Input Delay):</strong> 
          ${vitalsResults.fid ? `${vitalsResults.fid.toFixed(0)}ms` : 'Measuring...'} 
          ${vitalsResults.fid ? (passed.fid ? '‚úÖ' : '‚ö†Ô∏è') : ''} 
          <span class="target">(Target: ‚â§ 100ms)</span>
        </div>
        <div class="metric ${passed.ttfb ? 'pass' : 'warn'}">
          <strong>TTFB (Time to First Byte):</strong> 
          ${vitalsResults.ttfb ? `${vitalsResults.ttfb.toFixed(0)}ms` : 'Measuring...'} 
          ${vitalsResults.ttfb ? (passed.ttfb ? '‚úÖ' : '‚ö†Ô∏è') : ''} 
          <span class="target">(Target: ‚â§ 800ms)</span>
        </div>
      `;
    }

    // Measure all vitals
    onCLS(sendToAnalytics);
    onINP(sendToAnalytics);
    onLCP(sendToAnalytics);
    onFCP(sendToAnalytics);
    onFID(sendToAnalytics);
    onTTFB(sendToAnalytics);

    // Initial display
    updateDisplay();

    // Export results after page load
    window.addEventListener('load', () => {
      setTimeout(() => {
        console.log('=== FINAL CORE WEB VITALS ===');
        console.table(vitalsResults);
        
        // Make results available globally
        window.webVitalsResults = vitalsResults;
      }, 5000);
    });
  </script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h2 {
      color: #333;
      border-bottom: 2px solid #0A2E50;
      padding-bottom: 10px;
    }
    h3 {
      color: #666;
      margin-top: 20px;
    }
    .metric {
      background: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 4px solid #ddd;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .metric.pass {
      border-left-color: #00A868;
    }
    .metric.fail {
      border-left-color: #ff4444;
    }
    .metric.warn {
      border-left-color: #ffaa00;
    }
    .target {
      color: #666;
      font-size: 0.9em;
    }
    hr {
      margin: 30px 0;
      border: none;
      border-top: 1px solid #ddd;
    }
    #app-container {
      margin-top: 40px;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div id="results">
    <h2>üìä Core Web Vitals Results</h2>
    <p>Measuring performance metrics...</p>
  </div>
  
  <div id="app-container">
    <h2>üéØ Test Application Content</h2>
    <p>This page measures Core Web Vitals. Interact with the page to measure INP and FID.</p>
    <button onclick="alert('Button clicked!')">Click me to test INP</button>
    <button onclick="console.log('Test interaction')">Another test button</button>
    
    <div style="margin-top: 20px;">
      <img src="https://via.placeholder.com/600x400" alt="Test image" style="max-width: 100%; height: auto;">
    </div>
    
    <div style="margin-top: 20px;">
      <h3>Test Content</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
    </div>
  </div>
  
  <script>
    // Add some content dynamically to test CLS
    setTimeout(() => {
      const div = document.createElement('div');
      div.innerHTML = '<p>Dynamic content loaded</p>';
      document.getElementById('app-container').appendChild(div);
    }, 1000);
  </script>
</body>
</html>
