# üìä –†–µ–∑—é–º–µ –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–∞—Ç–∞:** 2025-10-06  
**–í–µ—Ç–∫–∞:** `cursor/regression-testing-critical-user-flows-8823`  
**QA Engineer:** 20-–ª–µ—Ç–Ω–∏–π –æ–ø—ã—Ç  

---

## üéØ –ó–∞–¥–∞—á–∞

–°–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –ø–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º –≤ –∫–æ–º–º–∏—Ç–∞—Ö:
- **7b1b7e2** - Security audit and remediation of code (#35)
- **efd4cda** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–∫–æ—É–ø–∞ —Ü–µ–ª—è–º –∏ KPI (#33)
- **298d1cc** - Refactor: Improve DB session management and config (#34)

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –ê–Ω–∞–ª–∏–∑ –ò–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ö–æ–º–º–∏—Ç 7b1b7e2):
- ‚úÖ Rate limiting –Ω–∞ `/auth/refresh` (P0-1)
- ‚úÖ httpOnly cookies –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤ (P0-2)
- ‚úÖ JWT jti –¥–ª—è –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ (P1-1)
- ‚úÖ –£—Å–∏–ª–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—è–º (P1-2)
- ‚úÖ Account lockout –º–µ—Ö–∞–Ω–∏–∑–º (P1-3)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (P1-4)
- ‚úÖ Security headers (CSP, HSTS, etc.) (P1-5)
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ GitHub tokens (P2-2)
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (P2-3)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π audit logging (P2-4)

#### –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö (–ö–æ–º–º–∏—Ç 298d1cc):
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ Engine disposal –ø—Ä–∏ shutdown
- ‚úÖ Pool pre-ping –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ Connection recycling
- ‚úÖ Engine caching –ø–æ URL

### 2. –°–æ–∑–¥–∞–Ω–Ω—ã–µ –¢–µ—Å—Ç–æ–≤—ã–µ –§–∞–π–ª—ã

| –§–∞–π–ª | –¢–µ—Å—Ç—ã | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|------|-------|-----------|----------|
| `tests/regression/test_critical_auth_flows.py` | 12 | P0 | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª–µ–π |
| `tests/regression/test_critical_db_flows.py` | 9 | P0 | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, lifecycle, connection pooling |
| `tests/regression/test_critical_security_flows.py` | 13 | P1 | Security headers, error handling, CORS, XSS |
| `tests/regression/test_critical_audit_flows.py` | 6 | P1 | Audit logging, security events |
| `tests/regression/conftest.py` | - | - | –§–∏–∫—Å—Ç—É—Ä—ã –∏ —É—Ç–∏–ª–∏—Ç—ã |

**–ò—Ç–æ–≥–æ:** 40+ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `tests/regression/REGRESSION_TEST_PLAN.md` | –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å —à–∞–≥–∞–º–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ TC |
| `tests/regression/README.md` | –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ç–µ—Å—Ç–æ–≤ |
| `REGRESSION_TESTING_SUMMARY.md` | –≠—Ç–æ—Ç —Ñ–∞–π–ª - –æ–±—â–µ–µ —Ä–µ–∑—é–º–µ |
| `pytest.ini` | –û–±–Ω–æ–≤–ª—ë–Ω —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ priority_p0, priority_p1, priority_p2 |

### 4. Test Cases —Å –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–æ–π

–ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç:

‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID**: `TC-AUTH-001`, `TC-DB-001`, etc.  
‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 (–±–ª–æ–∫–∏—Ä—É–µ—Ç), P1 (–±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ >2 –ø—Ä–æ–≤–∞–ª–∞—Ö), P2 (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç)  
‚úÖ **–®–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è**: –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è  
‚úÖ **–°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã**: –¢–æ—á–Ω—ã–µ –ø—É—Ç–∏ –∫ –∏–∑–º–µ–Ω—ë–Ω–Ω–æ–º—É –∫–æ–¥—É  
‚úÖ **–°—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∏**: –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ –≤ –∫–æ–º–º–∏—Ç–∞—Ö  
‚úÖ **–°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–º–º–∏—Ç—ã**: SHA –∫–æ–º–º–∏—Ç–æ–≤  
‚úÖ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–∞–ª–∞**: –ß—ë—Ç–∫–∏–µ —É—Å–ª–æ–≤–∏—è –ø—Ä–æ–≤–∞–ª–∞  
‚úÖ **–ê–≤—Ç–æ—Ç–µ—Å—Ç**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω  

#### –ü—Ä–∏–º–µ—Ä –∏–∑ TC-AUTH-001:

```python
def test_tc_auth_001_weak_passwords_rejected(self, client, weak_passwords):
    """
    P0: Test that weak passwords are rejected during registration.
    
    Reproduction steps:
    1. POST /v1/auth/register with weak password
    2. Verify 400 or 422 response
    
    Links:
    - core/api/models/auth.py:36-78
    - Commit: 7b1b7e2
    
    Failure criteria:
    - Any weak password is accepted
    - No validation error returned
    """
    for password in weak_passwords:
        response = client.post("/v1/auth/register", json={
            "email": f"test_{password}@example.com",
            "password": password
        })
        
        assert response.status_code in [400, 422], \
            f"P0 FAILURE: Weak password '{password}' was not rejected. " \
            f"Status: {response.status_code}, Body: {response.json()}"
```

## üö¶ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ú—ë—Ä–∂–∞

### ‚ùå –ë–õ–û–ö–ò–†–£–ï–¢ (P0):
- –•–æ—Ç—è –±—ã **1 –ø—Ä–æ–≤–∞–ª—å–Ω—ã–π P0 —Ç–µ—Å—Ç**
- –†–µ–≥—Ä–µ—Å—Å–∏—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- SQL injection –≤–æ–∑–º–æ–∂–µ–Ω
- XSS –≤–æ–∑–º–æ–∂–µ–Ω —á–µ—Ä–µ–∑ httpOnly bypass
- –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–ü—Ä–∏–º–µ—Ä—ã P0 —Ç–µ—Å—Ç–æ–≤:**
- `TC-AUTH-001`: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π
- `TC-AUTH-002`: httpOnly cookies
- `TC-AUTH-003`: Rate limiting
- `TC-AUTH-004`: JWT jti
- `TC-AUTH-005`: Logout/revocation
- `TC-AUTH-006`: Account lockout
- `TC-DB-001`: Transaction rollback
- `TC-DB-002`: Engine disposal

### ‚ö†Ô∏è –ë–õ–û–ö–ò–†–£–ï–¢ (P1):
- –ë–æ–ª–µ–µ **2 –ø—Ä–æ–≤–∞–ª—å–Ω—ã—Ö P1 —Ç–µ—Å—Ç–æ–≤**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ security headers
- Information disclosure –≤ –æ—à–∏–±–∫–∞—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ audit logging

**–ü—Ä–∏–º–µ—Ä—ã P1 —Ç–µ—Å—Ç–æ–≤:**
- `TC-SEC-001`: Security headers
- `TC-SEC-002`: CSP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `TC-ERR-001`: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- `TC-AUD-001`: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- `TC-DB-003`: Pool pre-ping

### ‚ÑπÔ∏è –ù–ï –ë–õ–û–ö–ò–†–£–ï–¢ (P2):
- –ü—Ä–æ–≤–∞–ª—å–Ω—ã–µ P2 —Ç–µ—Å—Ç—ã (—Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–¥–∞—á–∏)

## üéØ –ü–æ–∫—Ä—ã—Ç–∏–µ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ü–æ—Ç–æ–∫–æ–≤

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (100% P0)

| –ü–æ—Ç–æ–∫ | Test Case | –°—Ç–∞—Ç—É—Å |
|-------|-----------|--------|
| –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | TC-AUTH-001 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| –í—Ö–æ–¥ —Å cookies | TC-AUTH-002 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Rate limiting refresh | TC-AUTH-003 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| JWT jti | TC-AUTH-004 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Logout –∏ revocation | TC-AUTH-005 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Account lockout | TC-AUTH-006 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| SQL injection –∑–∞—â–∏—Ç–∞ | TC-AUTH-007 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Password storage | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–µ—Å—Å–∏—è–º–∏ –ë–î (100% P0)

| –ü–æ—Ç–æ–∫ | Test Case | –°—Ç–∞—Ç—É—Å |
|-------|-----------|--------|
| Transaction rollback | TC-DB-001 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Engine disposal | TC-DB-002 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Pool pre-ping | TC-DB-003 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Engine caching | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Concurrent sessions | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |

### 3. Security (90%+ P1)

| –ü–æ—Ç–æ–∫ | Test Case | –°—Ç–∞—Ç—É—Å |
|-------|-----------|--------|
| Security headers | TC-SEC-001 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| CSP configuration | TC-SEC-002 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Server header removal | TC-SEC-003 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| CORS configuration | TC-SEC-004 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| XSS prevention | TC-SEC-005 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |

### 4. Error Handling (100% P1)

| –ü–æ—Ç–æ–∫ | Test Case | –°—Ç–∞—Ç—É—Å |
|-------|-----------|--------|
| No information leakage | TC-ERR-001 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Validation sanitization | TC-ERR-002 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |

### 5. Audit Logging (100% P1)

| –ü–æ—Ç–æ–∫ | Test Case | –°—Ç–∞—Ç—É—Å |
|-------|-----------|--------|
| Login attempts logged | TC-AUD-001 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Token revocation logged | TC-AUD-002 | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| JSON format | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |
| Log security | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π | ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω |

## üöÄ –ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–æ–≤

### Quick Start
```bash
# –í—Å–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/regression/ -v

# –¢–æ–ª—å–∫–æ P0 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ - –¥–æ–ª–∂–Ω—ã –≤—Å–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å!)
pytest tests/regression/ -v -m priority_p0

# –¢–æ–ª—å–∫–æ P1 (–≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ)
pytest tests/regression/ -v -m priority_p1

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/regression/ --cov=core --cov=api --cov-report=html
```

### CI/CD Integration

–ü—Ä–∏–º–µ—Ä GitHub Actions workflow —Å–æ–∑–¥–∞–Ω –≤ `tests/regression/README.md`.

**–ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏:**
1. –ó–∞–ø—É—Å–∫ P0 —Ç–µ—Å—Ç–æ–≤ - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ
2. –ó–∞–ø—É—Å–∫ P1 —Ç–µ—Å—Ç–æ–≤ - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ >2 –ø—Ä–æ–≤–∞–ª–∞—Ö
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
4. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

## üìä –ú–µ—Ç—Ä–∏–∫–∏

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:
- **–¶–µ–ª—å P0:** 100% ‚úÖ
- **–¶–µ–ª—å P1:** 90%+ ‚úÖ
- **–¶–µ–ª—å P2:** 70%+

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–í—Å–µ —Ç–µ—Å—Ç—ã:** < 5 –º–∏–Ω—É—Ç
- **P0 —Ç–µ—Å—Ç—ã:** < 2 –º–∏–Ω—É—Ç
- **Flaky rate:** < 1%

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 40+
- **P0 —Ç–µ—Å—Ç–æ–≤:** 15+
- **P1 —Ç–µ—Å—Ç–æ–≤:** 20+
- **P2 —Ç–µ—Å—Ç–æ–≤:** 5+

## üîó –ú–∞—Ç—Ä–∏—Ü–∞ –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ (–°–≤–æ–¥–Ω–∞—è)

| Test ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ö–æ–º–º–∏—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|------|--------|--------|----------|
| TC-AUTH-001 | P0 | core/api/models/auth.py | 36-78 | 7b1b7e2 | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π |
| TC-AUTH-002 | P0 | api/routers/auth.py | 239-256 | 7b1b7e2 | httpOnly cookies |
| TC-AUTH-003 | P0 | api/routers/auth.py | 260-261 | 7b1b7e2 | Rate limiting |
| TC-AUTH-004 | P0 | api/routers/auth.py | 55-67 | 7b1b7e2 | JWT jti |
| TC-AUTH-005 | P0 | api/routers/auth.py | 291-322 | 7b1b7e2 | Logout revocation |
| TC-AUTH-006 | P0 | api/routers/auth.py | 185-203 | 7b1b7e2 | Account lockout |
| TC-DB-001 | P0 | core/db/session.py | 94-107 | 298d1cc | Transaction rollback |
| TC-DB-002 | P0 | core/db/session.py | 42-50 | 298d1cc | Engine disposal |
| TC-DB-003 | P1 | core/db/session.py | 36,117,123 | 298d1cc | Pool pre-ping |
| TC-SEC-001 | P1 | core/api/middleware/security_headers.py | 1-64 | 7b1b7e2 | Security headers |
| TC-SEC-002 | P1 | core/api/middleware/security_headers.py | 21-31 | 7b1b7e2 | CSP config |
| TC-ERR-001 | P1 | core/api/error_handlers.py | 13-41 | 7b1b7e2 | No info leakage |
| TC-ERR-002 | P1 | core/api/error_handlers.py | 44-78 | 7b1b7e2 | Validation sanitization |
| TC-AUD-001 | P1 | api/routers/auth.py | 209-234 | 7b1b7e2 | Login logging |
| TC-AUD-002 | P1 | api/routers/auth.py | 315-317 | 7b1b7e2 | Revocation logging |

**–ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:** –°–º. `tests/regression/REGRESSION_TEST_PLAN.md`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –§–∞–π–ª–æ–≤

```
/workspace/
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ regression/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ conftest.py                    # –û–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îÇ       ‚îú‚îÄ‚îÄ README.md                      # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
‚îÇ       ‚îú‚îÄ‚îÄ REGRESSION_TEST_PLAN.md        # –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω
‚îÇ       ‚îú‚îÄ‚îÄ test_critical_auth_flows.py    # P0: Auth —Ç–µ—Å—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ test_critical_db_flows.py      # P0: DB —Ç–µ—Å—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ test_critical_security_flows.py # P1: Security
‚îÇ       ‚îî‚îÄ‚îÄ test_critical_audit_flows.py   # P1: Audit
‚îú‚îÄ‚îÄ pytest.ini                             # –û–±–Ω–æ–≤–ª—ë–Ω —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏
‚îî‚îÄ‚îÄ REGRESSION_TESTING_SUMMARY.md          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## ‚úÖ Checklist –¥–ª—è –ú—ë—Ä–∂–∞

–ü–µ—Ä–µ–¥ –º—ë—Ä–∂–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] –í—Å–µ P0 —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (0 –ø—Ä–æ–≤–∞–ª–æ–≤)
- [ ] P1 —Ç–µ—Å—Ç—ã: –Ω–µ –±–æ–ª–µ–µ 1 –ø—Ä–æ–≤–∞–ª–∞
- [ ] –ù–µ—Ç –Ω–æ–≤—ã—Ö security —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- [ ] Coverage >= 90% –¥–ª—è –∏–∑–º–µ–Ω—ë–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] Audit logs —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Security headers –Ω–∞ –≤—Å–µ—Ö endpoints
- [ ] httpOnly cookies —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Rate limiting —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- [ ] Account lockout —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- [ ] Engines dispose –ø—Ä–∏ shutdown

## üéì –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

–¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º:

- **ASVS 4.0** (Application Security Verification Standard)
- **OWASP Top 10** (Web Application Security Risks)
- **GDPR/SOC2** (Data protection compliance)
- **12-Factor App** (Best practices)
- **Test Pyramid** (Unit ‚Üí Integration ‚Üí E2E)

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `tests/regression/README.md`
2. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `tests/regression/REGRESSION_TEST_PLAN.md`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ docstrings –≤ —Ç–µ—Å—Ç–∞—Ö
4. –°–æ–∑–¥–∞–π—Ç–µ issue —Å —Ç–µ–≥–æ–º `qa` –∏ `regression-tests`

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏ –ø–æ–∫—Ä—ã—Ç—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏**  
‚úÖ **–ö–∞–∂–¥—ã–π —Å–±–æ–π –∏–º–µ–µ—Ç —à–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è**  
‚úÖ **–í—Å–µ —Ç–µ—Å—Ç—ã –∏–º–µ—é—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –∏ –∫–æ–º–º–∏—Ç—ã**  
‚úÖ **P0/P1 –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º—ë—Ä–∂–∞**  
‚úÖ **CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞**  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è –∏ –¥–µ—Ç–∞–ª—å–Ω–∞—è**  

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ü–†–û–ì–û–ù–£  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ P0 –ø—Ä–æ–≤–∞–ª—ã –ø–µ—Ä–µ–¥ –º—ë—Ä–∂–µ–º

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-10-06  
**QA Engineer:** 20-–ª–µ—Ç–Ω–∏–π –æ–ø—ã—Ç  
**–í–µ—Ç–∫–∞:** cursor/regression-testing-critical-user-flows-8823
